<html>

<head>
  <title>Test Data Generator and Table Editor for Markdown,  CSV, json, html</title>
  <meta name="description" content="A Test Data Generator and Data Table Editor. Convert to and from tables for Markdown, CSV, JSON and JavaScript Arrays. Import and export from files. Edit, sort, filter in the Data Grid. Generate Test Data into the grid.">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Alan Richardson">
  <script src="https://unpkg.com/ag-grid-community@26.2.1/dist/ag-grid-community.min.js"></script>
  <script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js"></script>
  <script src="customHeader.js"></script>
  <script src="script.js"></script>
  <script src="exporter.js"></script>
  <script src="importer.js"></script>
  <script src="gridExtension.js"></script>
  <script src="gridControl.js"></script>
  <script src="dragDropControl.js"></script>
  <script src="download.js"></script>
  <script src="exportControls.js"></script>


  <!-- random data generation -->
  <!-- https://github.com/Marak/faker.js -->
  <script src="https://unpkg.com/faker@5.5.3/dist/faker.min.js"></script>
  <!-- http://fent.github.io/randexp.js/ -->
  <script src="libs/randexp.min.js"></script>
  <script type="module" src="./data_generation/testDataRules.js"></script>
  <script type="module" src="testdatadefn.js"></script>

  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>

  <!-- 
    TODOs:

    Change Grid Column Size Based on Number of columns e.g. 1 == 75%, 2==50%, 3=33%, then autosize
    Refactor code into classes
    Duplicate Row (Below, Above)
    Handle markdown alignment - import and export
    Option: Emboldened Headings on export and render in grid
    Handle Emboldened Headings in Markdown import
    User configured options e.g. confirm for delete, markdown format (front and end bars)
    Error handling and reporting
    New Export formats: spaced Text (config on number of spaces), Tab Delimited,  text table +----+ format, restructured text format, sql create table and inserts
  -->

  <div class="header">
  <h1 class="appheading">Data Table Editor & Generator</h1>
  <div class="instructions">
  <details>
    <summary>Instructions</summary>
    <ul>
      <li>[Reset Table] To clear all table data</li>
      <li> Expand '&gt; Instructions' to read the instructions</li>
      <li>[~] Rename Column</li>
      <li>[x] Delete Column</li>
      <li>[&lt;+] Add Column Left</li>
      <li>[+=] Duplicate this column</li>
      <li>[+&gt;] Add Column Right</li>
      <li>Use tabs to switch between the type of text representation: markdown, csv, etc.</li>
      <li>Drag and drop files of selected representation to import.</li>
      <li>click [Set Text From Grid] to generate text from the Grid</li>
      <li>Enter format in the Text Area and click [Set Grid From Text] to generate the grid from the entered text type</li>
      <li>[Choose File] to Import chosen type e.g. CSV, Markdown file to set grid from the loaded file</li>
      <li>[Download ...] will download the grid as chosen format e.g CSV, Markdown</li>
      <li>Drag Columns to re-order</li>
      <li>Drag Rows to re-order</li>
      <li>Select multiple rows with ctrl and shift (cmd + shift on mac)</li>
      <li>Add new Rows with the [Add Row...] buttons</li>
      <li>[Delete Selected Rows] will delete any selected rows</li>
      <li>Use the filter icon on the left of each column to filter specific column.</li>
      <li>The up and down arrows in the header will sort the column, use (x) to clear the sort</li>
      <li>Use the Filter field to filter any column to match the text</li>
      <li>[Clear Filters] will clear the quick filter and all column filters</li>
      <li>Test Data can be generated by adding a set of (rulename \n rule) in text box</li>
      <li>Adding a number of rows to generate and clicking [Generate] button </li>
      <li>Rule can be a RegEx expression or a faker API call e.g. (Connie|Bob) or faker.name.firstName</li>
    </ul>
    <div class="footer">
    <p>
      Built by <a href="https://eviltester.com" target="_blank">Alan Richardson</a> with <a href="https://ag-grid.com" target="_blank">AG Grid</a> Community Edition, <a href="http://fent.github.io/randexp.js/" target="_blank">RandExp.js</a>
      and <a href="https://www.papaparse.com/" target="_blank">PapaParse</a> - [<a href="https://github.com/eviltester/grid-table-editor" target="_blank">github source</a>]
    </p>
  </div>
  </details>
</div>
</div>



  <div class="main-app">
  <div class="toolbar">
    <button id="addRowButton">Add Row</button>
    <button id="addRowsAboveButton">Add Rows Above</button>
    <button id="addRowsBelowButton">Add Rows Below</button>
    <button id="deleteSelectedRowsButton">Delete Selected Rows</button>
    <label for="filter-text-box">Filter:</label> <input type="text" id="filter-text-box" placeholder="Filter...">
    <button id="clearFiltersButton" title="Clear Filters">Clear Filters</button>
    <button id="clearTableButton" title="Clear All Data">Reset Table</button>
  </div>
  <!-- ag-theme-alpine -->
  <div id="myGrid" style="height: 500px; width:100%;" class="ag-theme-alpine"></div>
  <div class="importexport">
    <button onclick="renderTextFromGrid()">v Set Text From Grid v</button>
    <button id="importtextbutton" onclick="importText()">^ Set Grid From Text ^</button>
    <label id="csvinputlabel" for="csvinput"><span class="fileFormat">.csv</span> import ^:</label><input type="file" id="csvinput"/>
    <button id="filedownload"><span class="fileFormat">.csv</span> Download</button>
    <label id="dropzone">
      <span>[Drag And Drop <span class="fileFormat">.csv</span> File Here]</span>
  </label>
  </div>

  <div class="testDataDefnGui">
    <details>
      <summary>Test Data</summary>
      <div>
      <div>
          <button id="generatedata">Generate</button><label id="howmanygenerate" for="generateCount"> How Many?</label><input type="number" id="generateCount"/>
      </div>
        <div class="defn-edit-zone">
          <div class="defn-grid-container" id="defngrid" class="ag-theme-alpine" style="float:left"></div>
          <div class="defn-text-container" style="float:right;padding-top:2em"><textarea class="testDataDefn" name="testdatadefntext" id="testdatadefntext"></textarea></div>
        </div>
      </div>
    </details>
  </div>

  <div class="conversionTabs">
    <div id="conversionTypes" class="conversionTypes">
      <ul class="conversionTypesList">
        <li id="type-markdown" class="type-select">
          <a class="type-select-action" data-type="markdown" href="#">Markdown</a>
        </li>
        <li id="type-csv" class="type-select active-type">
          <a class="type-select-action" data-type="csv" href="#">CSV</a>
        </li>
        <li id="type-json" class="type-select">
          <a class="type-select-action" data-type="json" href="#">JSON</a>
        </li>
        <li id="type-javascript" class="type-select">
          <a class="type-select-action" data-type="javascript" href="#">JavaScript</a>
        </li>
        <li id="type-gherkin" class="type-select">
          <a class="type-select-action" data-type="gherkin" href="#">Gherkin</a>
        </li>
        <li id="type-html" class="type-select">
          <a class="type-select-action" data-type="html" href="#">HTML</a>
        </li>
      </ul>
    </div>
    <div class="rightbuttons">
      <button title="Copy text to clipboard" id="copyTextButton">Copy</button>
    </div>
  </div>


  <div id="markdown" style="height: 30%; width:100%;">
    <textarea class="textrepresentation" name="Markdown" id="markdownarea"></textarea>
  </div>


  <script>
    window.addEventListener('load', function() {
      document.querySelectorAll(".type-select-action").forEach( lielem => lielem.addEventListener("click", (e) => {

        // set the display buttons
        document.querySelectorAll(".type-select").forEach(elem => elem.classList.remove("active-type"));
        var elem = e.target;
        liItem = elem.parentElement.classList.add("active-type");

        // switched tab so re-render text
        renderTextFromGrid();
        setFileFormatType();
        // don't try to navigate
        return false;
      }));
    })
  </script>



</body>


</html>