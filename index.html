<html>

<head>
  <meta charset="UTF-8" />
  <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>
  <script src="https://unpkg.com/papaparse@latest/papaparse.min.js"></script>
  <script src="customHeader.js"></script>
  <script src="script.js"></script>
  <script src="exporter.js"></script>
  <script src="importer.js"></script>
  <script src="gridExtension.js"></script>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>

  <!-- 
    TODOs:

    Import from file: Markdown, JSON
  -->

  <h1 class="appheading">Simple Data Table Editor</h1>
  <div class="instructions">
  <details>
    <summary>Instructions</summary>
    <ul>
      <li>[~] Rename Column</li>
      <li>[x] Delete Column</li>
      <li>[&lt;+] Add Column Left</li>
      <li>[+&gt;] Add Column Right</li>
      <li>Use tabs to switch between the type of text representation: markdown, csv, etc.</li>
      <li>click [Set Text From Grid] to generate text from the Grid</li>
      <li>Enter format in the Text Area and click [Set Grid From Text] to generate the grid from the entered text type</li>
      <li>Import CSV file to set grid from the loaded file</li>
      <li>[CSV Export] will download the grid as CSV</li>
      <li>Drag Columns to re-order</li>
      <li>Drag Rows to re-order</li>
      <li>Select multiple rows with ctrl and shift (cmd + shift on mac)</li>
      <li>Add new Rows with the [Add Row...] buttons</li>
      <li>[Delete Selected Rows] will delete any selected rows</li>
    </ul>
  </details>
</div>


  <div class="toolbar">
    <button onclick="addRow()">Add Row</button>
    <button onclick="addRows(-1)">Add Rows Above</button>
    <button onclick="addRows(1)">Add Rows Below</button>
    <button onclick="deleteSelectedRows()">Delete Selected Rows</button>
  </div>
  <!-- ag-theme-alpine -->
  <div id="myGrid" style="height: 500px; width:100%;" class="ag-theme-alpine"></div>
  <div class="importexport">
    <button onclick="renderTextFromGrid()">v Set Text From Grid v</button>
    <button onclick="importText()">^ Set Grid From Text ^</button>
    <label for="csvinput">.csv import ^:</label><input type="file" id="csvinput">
    <button onclick="fileDownload()">Download</button>
  </div>

  <div id="conversionTypes" class="conversionTypes">
    <ul class="conversionTypesList">
      <li id="type-markdown" class="type-select active-type">
        <a class="type-select-action" data-type="markdown" href="#">Markdown</a>
      </li>
      <li id="type-csv" class="type-select">
        <a class="type-select-action" data-type="csv" href="#">CSV</a>
      </li>
      <li id="type-json" class="type-select">
        <a class="type-select-action" data-type="json" href="#">JSON</a>
      </li>
      <li id="type-javascript" class="type-select">
        <a class="type-select-action" data-type="javascript" href="#">JavaScript</a>
      </li>
    </ul>
  </div>

  <div id="markdown" style="height: 30%; width:100%;">
    <textarea class="textrepresentation" name="Markdown" id="markdownarea"></textarea>
  </div>

  <Script>
    document.querySelectorAll(".type-select-action").forEach( lielem => lielem.addEventListener("click", (e) => {

      // set the display buttons
      document.querySelectorAll(".type-select").forEach(elem => elem.classList.remove("active-type"));
      var elem = e.target;
      liItem = elem.parentElement.classList.add("active-type");

      // switched tab so re-render text
      renderTextFromGrid();

      // don't try to navigate
      return false;
    }));
  </Script>
  <p>
    Built by <a href="https://eviltester.com" target="_blank">Alan Richardson</a> with <a href="https://ag-grid.com" target="_blank">AG Grid</a> Community Edition,
    and <a href="https://www.papaparse.com/" target="_blank">PapaParse</a>
  </p>
</body>


</html>